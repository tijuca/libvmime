From: Carsten Schoenert <c.schoenert@t-online.de>
Date: Sat, 25 Apr 2015 13:33:05 +0200
Subject: backport mailboxList parser

---
 src/mailboxList.cpp | 30 +++++++++++++++++++++++++++++-
 vmime/address.hpp   |  1 -
 2 files changed, 29 insertions(+), 2 deletions(-)

diff --git a/src/mailboxList.cpp b/src/mailboxList.cpp
index 0023d9d..6b19a87 100644
--- a/src/mailboxList.cpp
+++ b/src/mailboxList.cpp
@@ -22,6 +22,7 @@
 //
 
 #include "vmime/mailboxList.hpp"
+#include "vmime/mailboxGroup.hpp"
 #include "vmime/exception.hpp"
 
 
@@ -199,7 +200,34 @@ const std::vector <ref <const component> > mailboxList::getChildComponents() con
 void mailboxList::parse(const string& buffer, const string::size_type position,
 	const string::size_type end, string::size_type* newPosition)
 {
-	m_list.parse(buffer, position, end, newPosition);
+	string::size_type pos = position;
+
+	while (pos < end)
+	{
+		ref <address> parsedAddress = address::parseNext(buffer, pos, end, &pos);
+
+		if (parsedAddress != NULL)
+		{
+			if (parsedAddress->isGroup())
+			{
+				ref <mailboxGroup> group = parsedAddress.staticCast <mailboxGroup>();
+
+				for (size_t i = 0 ; i < group->getMailboxCount() ; ++i)
+				{
+					m_list.appendAddress(group->getMailboxAt(i));
+				}
+			}
+			else
+			{
+				m_list.appendAddress(parsedAddress);
+			}
+		}
+	}
+
+	setParsedBounds(position, end);
+
+	if (newPosition)
+		*newPosition = end;
 }
 
 
diff --git a/vmime/address.hpp b/vmime/address.hpp
index 188d6ec..d975810 100644
--- a/vmime/address.hpp
+++ b/vmime/address.hpp
@@ -65,7 +65,6 @@ public:
 
 	virtual ref <component> clone() const = 0;
 
-protected:
 
 	/** Parse an address from an input buffer.
 	  *
